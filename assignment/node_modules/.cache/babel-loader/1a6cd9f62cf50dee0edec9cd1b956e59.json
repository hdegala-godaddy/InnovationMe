{"ast":null,"code":"import ThresholdFetchService from './ThresholdFetchService';\n\nfunction Node(empDetails) {\n  if (!empDetails) return null;\n  let obj = {};\n  obj[empDetails.name] = {\n    'id': empDetails.id,\n    'reports': []\n  };\n  return obj;\n}\n\nclass EmpFetchService {\n  constructor(empId, callBack) {\n    //this.empTree = new Map();\n    this.empIDToTreeNodeMap = new Map();\n    this.initialEmpId = empId;\n    this.callBack = callBack;\n  }\n\n  insertIntoTree(parentEmpId, parentName, empId, node) {\n    this.empIDToTreeNodeMap.set(empId, node);\n\n    if (parentEmpId) {\n      let parentNode = this.empIDToTreeNodeMap.get(parentEmpId);\n      parentNode[parentName].reports.push(node);\n    }\n  }\n\n  async fetchAndFillEmpDetails(empId = this.initialEmpId, parentEmpId = null, parentName = '') {\n    try {\n      let empDetails = await ThresholdFetchService.fetch(empId);\n      let treeNode = new Node(empDetails);\n      this.insertIntoTree(parentEmpId, parentName, empId, treeNode);\n      this.callBack(this.empIDToTreeNodeMap);\n      empDetails.reports.forEach(id => {\n        if (!this.empIDToTreeNodeMap.has(id)) {\n          this.fetchAndFillEmpDetails(id, empId, empDetails.name);\n        }\n      });\n    } catch (excp) {\n      // alert(excp);\n      console.log(excp);\n    }\n\n    return this.empIDToTreeNodeMap;\n  }\n\n  getJson() {\n    return this.empIDToTreeNodeMap.get(this.initialEmpId);\n  }\n\n}\n\nexport default EmpFetchService;","map":{"version":3,"sources":["/Users/harshadegala/Code/React/assignment/src/EmpFetchService.js"],"names":["ThresholdFetchService","Node","empDetails","obj","name","id","EmpFetchService","constructor","empId","callBack","empIDToTreeNodeMap","Map","initialEmpId","insertIntoTree","parentEmpId","parentName","node","set","parentNode","get","reports","push","fetchAndFillEmpDetails","fetch","treeNode","forEach","has","excp","console","log","getJson"],"mappings":"AAAA,OAAOA,qBAAP,MAAkC,yBAAlC;;AAGA,SAASC,IAAT,CAAcC,UAAd,EAAyB;AACrB,MAAI,CAACA,UAAL,EACI,OAAO,IAAP;AAEJ,MAAIC,GAAG,GAAG,EAAV;AACAA,EAAAA,GAAG,CAACD,UAAU,CAACE,IAAZ,CAAH,GAAuB;AACnB,UAAOF,UAAU,CAACG,EADC;AAEnB,eAAY;AAFO,GAAvB;AAIA,SAAOF,GAAP;AACH;;AAED,MAAMG,eAAN,CAAqB;AAEjBC,EAAAA,WAAW,CAACC,KAAD,EAAQC,QAAR,EAAiB;AACxB;AACA,SAAKC,kBAAL,GAA0B,IAAIC,GAAJ,EAA1B;AACA,SAAKC,YAAL,GAAoBJ,KAApB;AACA,SAAKC,QAAL,GAAgBA,QAAhB;AACH;;AAEDI,EAAAA,cAAc,CAACC,WAAD,EAAaC,UAAb,EAAyBP,KAAzB,EAA+BQ,IAA/B,EAAoC;AAE9C,SAAKN,kBAAL,CAAwBO,GAAxB,CAA4BT,KAA5B,EAAmCQ,IAAnC;;AACA,QAAIF,WAAJ,EAAiB;AACb,UAAII,UAAU,GAAG,KAAKR,kBAAL,CAAwBS,GAAxB,CAA4BL,WAA5B,CAAjB;AACAI,MAAAA,UAAU,CAACH,UAAD,CAAV,CAAuBK,OAAvB,CAA+BC,IAA/B,CAAoCL,IAApC;AACH;AACJ;;AAED,QAAMM,sBAAN,CAA6Bd,KAAK,GAAG,KAAKI,YAA1C,EAAwDE,WAAW,GAAG,IAAtE,EAA4EC,UAAU,GAAC,EAAvF,EAA0F;AAEtF,QAAI;AACA,UAAIb,UAAU,GAAG,MAAMF,qBAAqB,CAACuB,KAAtB,CAA4Bf,KAA5B,CAAvB;AACA,UAAIgB,QAAQ,GAAG,IAAIvB,IAAJ,CAASC,UAAT,CAAf;AACA,WAAKW,cAAL,CAAoBC,WAApB,EAAiCC,UAAjC,EAA6CP,KAA7C,EAAoDgB,QAApD;AACA,WAAKf,QAAL,CAAc,KAAKC,kBAAnB;AAEAR,MAAAA,UAAU,CAACkB,OAAX,CAAmBK,OAAnB,CAA4BpB,EAAD,IAAQ;AAC/B,YAAI,CAAC,KAAKK,kBAAL,CAAwBgB,GAAxB,CAA4BrB,EAA5B,CAAL,EAAsC;AAClC,eAAKiB,sBAAL,CAA4BjB,EAA5B,EAA+BG,KAA/B,EAAsCN,UAAU,CAACE,IAAjD;AACH;AACJ,OAJD;AAQH,KAdD,CAcE,OAAMuB,IAAN,EAAY;AACX;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACF;;AAED,WAAO,KAAKjB,kBAAZ;AACH;;AAEDoB,EAAAA,OAAO,GAAE;AACL,WAAO,KAAKpB,kBAAL,CAAwBS,GAAxB,CAA4B,KAAKP,YAAjC,CAAP;AACH;;AA5CgB;;AA+CrB,eAAeN,eAAf","sourcesContent":["import ThresholdFetchService from './ThresholdFetchService';\n\n\nfunction Node(empDetails){\n    if (!empDetails)\n        return null;\n\n    let obj = {};\n    obj[empDetails.name] = {\n        'id' : empDetails.id,\n        'reports' : []\n    };\n    return obj;\n}\n\nclass EmpFetchService{\n\n    constructor(empId, callBack){\n        //this.empTree = new Map();\n        this.empIDToTreeNodeMap = new Map();\n        this.initialEmpId = empId;\n        this.callBack = callBack;\n    }\n\n    insertIntoTree(parentEmpId,parentName, empId,node){\n        \n        this.empIDToTreeNodeMap.set(empId, node);\n        if (parentEmpId) {\n            let parentNode = this.empIDToTreeNodeMap.get(parentEmpId);\n            parentNode[parentName].reports.push(node);\n        }\n    }\n\n    async fetchAndFillEmpDetails(empId = this.initialEmpId, parentEmpId = null, parentName=''){\n\n        try {\n            let empDetails = await ThresholdFetchService.fetch(empId);\n            let treeNode = new Node(empDetails);\n            this.insertIntoTree(parentEmpId, parentName, empId, treeNode);\n            this.callBack(this.empIDToTreeNodeMap);\n            \n            empDetails.reports.forEach((id) => {\n                if (!this.empIDToTreeNodeMap.has(id)) {\n                    this.fetchAndFillEmpDetails(id,empId, empDetails.name);\n                }\n            });\n\n            \n\n        } catch(excp) {\n           // alert(excp);\n           console.log(excp);\n        }\n\n        return this.empIDToTreeNodeMap;\n    }\n\n    getJson(){\n        return this.empIDToTreeNodeMap.get(this.initialEmpId);\n    }\n}\n\nexport default EmpFetchService;\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}